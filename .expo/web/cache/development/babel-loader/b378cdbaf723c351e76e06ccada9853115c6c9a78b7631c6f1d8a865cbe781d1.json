{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport SafeAreaView from \"react-native-web/dist/exports/SafeAreaView\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport ActivityIndicator from \"react-native-web/dist/exports/ActivityIndicator\";\nimport Dimensions from \"react-native-web/dist/exports/Dimensions\";\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport View from \"react-native-web/dist/exports/View\";\nimport StatusBar from \"react-native-web/dist/exports/StatusBar\";\nimport React, { useEffect, useState } from 'react';\nimport * as Font from \"expo-font\";\nimport { Styles, Fonts, GalleryViewStyles } from \"../static/styles/styles\";\nimport * as MediaLibrary from \"expo-media-library\";\nimport ImageListItem from \"./ImageListItem\";\nimport Clickable from \"./Clickable\";\nvar dimentions = Dimensions.get('screen');\nimport { useIsFocused } from '@react-navigation/native';\nimport { Components } from \"../static/styles/styles\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nexport default function GalleryView(_ref) {\n  var navigation = _ref.navigation;\n  var _useState = useState([]),\n    _useState2 = _slicedToArray(_useState, 2),\n    photos = _useState2[0],\n    setPhotos = _useState2[1];\n  var isFocused = useIsFocused();\n  var _useState3 = useState(4),\n    _useState4 = _slicedToArray(_useState3, 2),\n    columns = _useState4[0],\n    setColumns = _useState4[1];\n  var _useState5 = useState(false),\n    _useState6 = _slicedToArray(_useState5, 2),\n    visibility = _useState6[0],\n    setVisibility = _useState6[1];\n  var loadData = function () {\n    var _ref2 = _asyncToGenerator(function* () {\n      setVisibility(false);\n      var data = yield MediaLibrary.getAssetsAsync({\n        first: 100,\n        mediaType: 'photo'\n      });\n      data.assets.map(function (el, i) {\n        el.selected = false;\n      });\n      setPhotos(data.assets);\n      setVisibility(true);\n    });\n    return function loadData() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n  useEffect(function () {\n    _asyncToGenerator(function* () {\n      var _yield$MediaLibrary$r = yield MediaLibrary.requestPermissionsAsync(),\n        status = _yield$MediaLibrary$r.status;\n      if (status !== 'granted') {\n        Alert.alert('brak uprawnień do czytania image-ów z galerii');\n      } else {\n        if (isFocused) loadData();\n      }\n    })();\n  }, [isFocused]);\n  var changeNumberOfColumns = function changeNumberOfColumns() {\n    return setColumns(columns == 1 ? 4 : 1);\n  };\n  var deleteSelectedImages = function () {\n    var _ref4 = _asyncToGenerator(function* () {\n      setVisibility(false);\n      yield MediaLibrary.deleteAssetsAsync(photos.filter(function (p) {\n        return p.selected;\n      }));\n      yield loadData();\n    });\n    return function deleteSelectedImages() {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n  var showBigPhoto = function showBigPhoto(item) {\n    navigation.navigate(\"image\", {\n      data: item\n    });\n  };\n  return _jsx(_Fragment, {\n    children: !visibility ? _jsx(SafeAreaView, {\n      children: _jsx(ActivityIndicator, {\n        size: \"large\",\n        color: \"#0000ff\"\n      })\n    }) : _jsxs(SafeAreaView, {\n      children: [_jsx(StatusBar, {}), _jsxs(View, {\n        style: {\n          flexDirection: \"row\",\n          gap: 20,\n          justifyContent: \"center\"\n        },\n        children: [_jsx(Clickable, {\n          text: \"[columns]\",\n          handlePress: changeNumberOfColumns,\n          styles: [Components.Button]\n        }), _jsx(Clickable, {\n          text: \"[camera]\",\n          handlePress: function handlePress() {\n            return navigation.navigate(\"camera\");\n          },\n          styles: [Components.Button]\n        }), _jsx(Clickable, {\n          text: \"[delete]\",\n          handlePress: deleteSelectedImages,\n          styles: [Components.Button]\n        })]\n      }), _jsx(FlatList, {\n        data: photos,\n        numColumns: columns,\n        keyExtractor: function keyExtractor(item) {\n          return item.id;\n        },\n        renderItem: function renderItem(_ref5) {\n          var item = _ref5.item,\n            index = _ref5.index;\n          return _jsx(ImageListItem, {\n            navigation: navigation,\n            item: _objectSpread(_objectSpread({}, item), {}, {\n              elements: columns,\n              dimentions: dimentions\n            }),\n            setPhotos: setPhotos,\n            photos: photos,\n            showBigPhoto: showBigPhoto,\n            index: index\n          });\n        },\n        style: {\n          marginBottom: 90\n        }\n      }, columns)]\n    })\n  });\n}","map":{"version":3,"names":["React","useEffect","useState","Font","Styles","Fonts","GalleryViewStyles","MediaLibrary","ImageListItem","Clickable","dimentions","Dimensions","get","useIsFocused","Components","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","GalleryView","_ref","navigation","_useState","_useState2","_slicedToArray","photos","setPhotos","isFocused","_useState3","_useState4","columns","setColumns","_useState5","_useState6","visibility","setVisibility","loadData","_ref2","_asyncToGenerator","data","getAssetsAsync","first","mediaType","assets","map","el","i","selected","apply","arguments","_yield$MediaLibrary$r","requestPermissionsAsync","status","Alert","alert","changeNumberOfColumns","deleteSelectedImages","_ref4","deleteAssetsAsync","filter","p","showBigPhoto","item","navigate","children","SafeAreaView","ActivityIndicator","size","color","StatusBar","View","style","flexDirection","gap","justifyContent","text","handlePress","styles","Button","FlatList","numColumns","keyExtractor","id","renderItem","_ref5","index","_objectSpread","elements","marginBottom"],"sources":["C:/Users/werd/Desktop/web-developing/react-native-cam-app/components/GalleryView.jsx"],"sourcesContent":["import { Alert, SafeAreaView, Text, ActivityIndicator, Dimensions, FlatList, View, StatusBar } from 'react-native'\r\nimport React, { useEffect, useState } from 'react'\r\nimport * as Font from \"expo-font\";\r\nimport { Styles, Fonts, GalleryViewStyles } from \"../static/styles/styles\"\r\nimport * as MediaLibrary from \"expo-media-library\";\r\nimport ImageListItem from \"./ImageListItem\"\r\nimport Clickable from \"./Clickable\"\r\nconst dimentions = Dimensions.get('screen')\r\nimport { useIsFocused } from '@react-navigation/native';\r\nimport {Components} from \"../static/styles/styles\"\r\nexport default function GalleryView({ navigation }) {\r\n    const [photos, setPhotos] = useState([])\r\n    const isFocused = useIsFocused();\r\n    const [columns, setColumns] = useState(4)\r\n    const [visibility, setVisibility] = useState(false)\r\n    const loadData = async() =>\r\n    {\r\n        setVisibility(false)\r\n        let data = await MediaLibrary.getAssetsAsync({\r\n            first: 100,           // ilość pobranych assetów\r\n            mediaType: 'photo'    // typ pobieranych danych, photo jest domyślne\r\n        })\r\n        data.assets.map((el,i)=>{\r\n            el.selected = false;\r\n        })\r\n        // data.assets = data.assets.sort((a,b)=> b.modificationTime - a.modificationTime)\r\n        setPhotos(data.assets)\r\n        setVisibility(true)\r\n    }\r\n    useEffect(() => {\r\n        (async () => {\r\n            let { status } = await MediaLibrary.requestPermissionsAsync();\r\n            if (status !== 'granted') {\r\n                Alert.alert('brak uprawnień do czytania image-ów z galerii')\r\n            }\r\n            else {\r\n                if(isFocused) loadData()\r\n            }\r\n        })()\r\n    }, [isFocused])\r\n    const changeNumberOfColumns = () => setColumns((columns == 1)? 4 : 1)\r\n    const deleteSelectedImages = async () =>{\r\n        setVisibility(false)\r\n        await MediaLibrary.deleteAssetsAsync(photos.filter(p => p.selected))\r\n        await loadData()\r\n    }\r\n    const showBigPhoto = (item) =>{\r\n        navigation.navigate(\"image\",{data: item})\r\n    }\r\n    return (\r\n        <>\r\n            {\r\n                !visibility ?\r\n                    <SafeAreaView>\r\n                        <ActivityIndicator size=\"large\" color=\"#0000ff\" />\r\n                    </SafeAreaView>\r\n                    :\r\n                    <SafeAreaView>\r\n                        <StatusBar />\r\n                        <View style={{flexDirection:\"row\", gap:20, justifyContent:\"center\"}}>\r\n                        <Clickable text={\"[columns]\"} handlePress={changeNumberOfColumns} styles={[Components.Button]} />\r\n                        <Clickable text={\"[camera]\"} handlePress={() => navigation.navigate(\"camera\")}  styles={[Components.Button]} />\r\n                        <Clickable text={\"[delete]\"} handlePress={deleteSelectedImages}  styles={[Components.Button]} />\r\n                        </View>\r\n                        <FlatList\r\n                            data={photos}\r\n                            numColumns={columns}\r\n                            key={columns}\r\n                            keyExtractor={item=>item.id}\r\n                            renderItem={({ item,index }) => <ImageListItem navigation={navigation} item={{ ...item, elements: columns, dimentions:dimentions}} setPhotos={setPhotos} photos={photos} showBigPhoto={showBigPhoto} index={index} />}\r\n                            style={{marginBottom:90}}\r\n                       ></FlatList>\r\n                    </SafeAreaView>\r\n            }\r\n        </>\r\n    )\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}